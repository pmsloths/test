
<!doctype html>
<html lang="vi" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="pmsloths blog">
      
      
        <meta name="author" content="pmsloths">
      
      
        <link rel="canonical" href="https://pmsloths.github.io/test/guide/function-preprocess/function-preprocessing/">
      
      <link rel="icon" href="../../../icon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.8">
    
    
      
        <title>Human Preprocessing VN - Work-life balance for PMs</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Ubuntu";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../style.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pipe" class="md-skip">
          VÃ o tháº³ng ná»™i dung
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Work-life balance for PMs" class="md-header__button md-logo" aria-label="Work-life balance for PMs" data-md-component="logo">
      
  <img src="../../../icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Work-life balance for PMs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Human Preprocessing VN
            
          </span>
        </div>
      </div>
    </div>
    
    
      <div class="md-header__option">
        <div class="md-select">
          
          <button class="md-header__button md-icon" aria-label="Select language">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
          </button>
          <div class="md-select__inner">
            <ul class="md-select__list">
              
                <li class="md-select__item">
                  <a href="./" hreflang="vi" class="md-select__link">
                    Viá»‡t Nam
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../../../en/guide/function-preprocess/function-preprocessing/" hreflang="en" class="md-select__link">
                    English
                  </a>
                </li>
                
            </ul>
          </div>
        </div>
      </div>
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="TÃ¬m kiáº¿m" placeholder="TÃ¬m kiáº¿m" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://www.linkedin.com/in/tobetwobees2b" title="Linkedin" class="md-source" data-md-component="source">
    <div class="md-source__icon md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </div>
    <div class="md-source__repository">
      Let's connect! ðŸ‘‹
    </div>
  </a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        Trang chá»§
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../function-classifier/function-classifier/" class="md-tabs__link md-tabs__link--active">
        HÆ°á»›ng dáº«n
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../api/classification/" class="md-tabs__link">
        Api 1
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../examples/model-mining/" class="md-tabs__link">
        VÃ­ dá»¥
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Work-life balance for PMs" class="md-nav__button md-logo" aria-label="Work-life balance for PMs" data-md-component="logo">
      
  <img src="../../../icon.png" alt="logo">

    </a>
    Work-life balance for PMs
  </label>
  
    <div class="md-nav__source">
      <a href="https://www.linkedin.com/in/tobetwobees2b" title="Linkedin" class="md-source" data-md-component="source">
    <div class="md-source__icon md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </div>
    <div class="md-source__repository">
      Let's connect! ðŸ‘‹
    </div>
  </a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Trang chá»§
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Trang chá»§" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Trang chá»§
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          HÆ°á»›ng dáº«n
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="HÆ°á»›ng dáº«n" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          HÆ°á»›ng dáº«n
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../function-classifier/function-classifier/" class="md-nav__link">
        Function as a Model VN
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Human Preprocessing VN
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Human Preprocessing VN
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Má»¥c lá»¥c">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Má»¥c lá»¥c
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pipe" class="md-nav__link">
    Pipe
  </a>
  
    <nav class="md-nav" aria-label="Pipe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#paramaters" class="md-nav__link">
    Paramaters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#with-pipe" class="md-nav__link">
    With .pipe()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#without-pipe" class="md-nav__link">
    Without .pipe()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pipetransformer" class="md-nav__link">
    PipeTransformer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utility" class="md-nav__link">
    Utility
  </a>
  
    <nav class="md-nav" aria-label="Utility">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dont-remove-data" class="md-nav__link">
    Don't remove data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dont-sort-data" class="md-nav__link">
    Don't sort data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dont-use-lambda" class="md-nav__link">
    Don't use lambda
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dont-cheat" class="md-nav__link">
    Don't Cheat!
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../drawing-classifier/drawing/" class="md-nav__link">
        Drawing as a Model VN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../finding-outliers/outliers/" class="md-nav__link">
        Outliers and Comfort VN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../drawing-features/custom-features/" class="md-nav__link">
        Drawing Features VN
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Api 1
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Api 1" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Api 1
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          Models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Models" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/classification/" class="md-nav__link">
        Classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/regression/" class="md-nav__link">
        Regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/outlier/" class="md-nav__link">
        Outlier
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/preprocessing/" class="md-nav__link">
        Preprocessing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2">
          Interactive
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Interactive" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Interactive
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/interactive-charts/" class="md-nav__link">
        Charts
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_3">
          Utility
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Utility" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Utility
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/common/" class="md-nav__link">
        Common
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/datasets/" class="md-nav__link">
        Datasets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/rulers/" class="md-nav__link">
        Rulers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          VÃ­ dá»¥
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="VÃ­ dá»¥" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          VÃ­ dá»¥
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/model-mining/" class="md-nav__link">
        Model Mining
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/usage/" class="md-nav__link">
        Sá»­ dá»¥ng
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Má»¥c lá»¥c">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Má»¥c lá»¥c
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pipe" class="md-nav__link">
    Pipe
  </a>
  
    <nav class="md-nav" aria-label="Pipe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#paramaters" class="md-nav__link">
    Paramaters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#with-pipe" class="md-nav__link">
    With .pipe()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#without-pipe" class="md-nav__link">
    Without .pipe()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pipetransformer" class="md-nav__link">
    PipeTransformer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utility" class="md-nav__link">
    Utility
  </a>
  
    <nav class="md-nav" aria-label="Utility">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dont-remove-data" class="md-nav__link">
    Don't remove data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dont-sort-data" class="md-nav__link">
    Don't sort data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dont-use-lambda" class="md-nav__link">
    Don't use lambda
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dont-cheat" class="md-nav__link">
    Don't Cheat!
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/pmsloths/test/edit/master/docs/guide/function-preprocess/function-preprocessing.md" title="Chá»‰nh sá»­a" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



  <h1>Human Preprocessing VN</h1>

<p>In python the most popular data analysis tool is pandas while the most popular
tool for making models is scikit-learn. We love the data wrangling tools of pandas
while we appreciate the benchmarking capability of scikit-learn.</p>
<p>The fact that these tools don't fully interact is slightly awkward. The data
going into the model has an big effect on the output.</p>
<p>So how might we more easily combine the two?</p>
<h2 id="pipe">Pipe<a class="headerlink" href="#pipe" title="Permanent link">&para;</a></h2>
<p>In pandas there's an amazing trick that you can do with the <code>.pipe</code> method. We'll
give a quick overview on how it works but if you're new to this idea you may appreciate
<a href="https://calmcode.io/pandas-pipe/introduction.html">this resource</a> or
<a href="https://tomaugspurger.github.io/method-chaining">this blogpost</a>.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">hulearn.datasets</span> <span class="kn">import</span> <span class="n">load_titanic</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">load_titanic</span><span class="p">(</span><span class="n">as_frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;survived&#39;</span><span class="p">]),</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;survived&#39;</span><span class="p">]</span>
<span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>

<p>The goal of the titanic dataset is to predict weather or not a passenger survived
the disaster. The <code>X</code> variable represents a dataframe with variables that we're going to use
to predict survival (stored in <code>y</code>). Here's a preview of what <code>X</code> might have.</p>
<table>
<thead>
<tr>
<th align="right">pclass</th>
<th align="left">name</th>
<th align="left">sex</th>
<th align="right">age</th>
<th align="right">fare</th>
<th align="right">sibsp</th>
<th align="right">parch</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">3</td>
<td align="left">Braund, Mr. Owen Harris</td>
<td align="left">male</td>
<td align="right">22</td>
<td align="right">7.25</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr>
<td align="right">3</td>
<td align="left">Heikkinen, Miss. Laina</td>
<td align="left">female</td>
<td align="right">26</td>
<td align="right">7.925</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr>
<td align="right">3</td>
<td align="left">Allen, Mr. William Henry</td>
<td align="left">male</td>
<td align="right">35</td>
<td align="right">8.05</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr>
<td align="right">1</td>
<td align="left">McCarthy, Mr. Timothy J</td>
<td align="left">male</td>
<td align="right">54</td>
<td align="right">51.8625</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Let's say we want to do some preprocessing. Maybe the length of name of somebody
says something about their status so we'd like to capture that. We could add this
feature with this line of code.</p>
<div class="codehilite"><pre><span></span><code><span class="n">X</span><span class="p">[</span><span class="s1">&#39;nchar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
</code></pre></div>

<p>This line of code has downsides though. It changes the original dataset. If we do
a lot of this then our code is going to turn into something unmaintainable rather
quickly. To prevent this, we might want to change the code into a function.</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">dataf</span><span class="p">):</span>
    <span class="c1"># Make a copy of the dataframe to prevent it from overwriting the original data.</span>
    <span class="n">dataf</span> <span class="o">=</span> <span class="n">dataf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1"># Make the changes</span>
    <span class="n">dataf</span><span class="p">[</span><span class="s1">&#39;nchar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataf</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
    <span class="c1"># Return the name dataframe</span>
    <span class="k">return</span> <span class="n">dataf</span>
</code></pre></div>

<p>We now have a nice function that makes our changes and we can use it like so;</p>
<div class="codehilite"><pre><span></span><code><span class="n">X_new</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre></div>

<p>We can do something more powerful though.</p>
<h3 id="paramaters">Paramaters<a class="headerlink" href="#paramaters" title="Permanent link">&para;</a></h3>
<p>Let's make some more changes to our <code>process</code> function.</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">preprocessing</span><span class="p">(</span><span class="n">dataf</span><span class="p">,</span> <span class="n">n_char</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gender</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">dataf</span> <span class="o">=</span> <span class="n">dataf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">n_char</span><span class="p">:</span>
        <span class="n">dataf</span><span class="p">[</span><span class="s1">&#39;nchar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataf</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">gender</span><span class="p">:</span>
        <span class="n">dataf</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">dataf</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;male&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dataf</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;sex&quot;</span><span class="p">])</span>
</code></pre></div>

<p>This function works slightly differently now. The most important part is that the
function now accepts arguments that change the way it behaves internally. The function
also drops the non-numeric columns at the end.</p>
<p>We've changed the way we've defined our function but we're also changing the way
that we're going to apply it.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># This is equivalent to preprocessing(X)</span>
<span class="n">X</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">preprocessing</span><span class="p">)</span>
</code></pre></div>

<p>The benefit of this notation is that if we have more functions that handle
data processing that it would remain a clean overview.</p>
<h3 id="with-pipe">With <code>.pipe()</code><a class="headerlink" href="#with-pipe" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="p">(</span><span class="n">df</span>
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">set_col_types</span><span class="p">)</span>
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">preprocessing</span><span class="p">,</span> <span class="n">nchar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gender</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">add_time_info</span><span class="p">))</span>
</code></pre></div>

<h3 id="without-pipe">Without <code>.pipe()</code><a class="headerlink" href="#without-pipe" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">add_time_info</span><span class="p">(</span><span class="n">preprocessing</span><span class="p">(</span><span class="n">set_col_types</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="n">nchar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gender</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</code></pre></div>

<p>Let's be honest, this looks messy.</p>
<h2 id="pipetransformer">PipeTransformer<a class="headerlink" href="#pipetransformer" title="Permanent link">&para;</a></h2>
<p>It would be great if we could use the <code>preprocessing</code>-function as part of a
scikit-learn pipeline that we can benchmark. It'd be great if we could use
a function with a pandas <code>.pipe</code>-line in general!</p>
<p>For that we've got another feature in our library, the <code>PipeTransformer</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">hulearn.preprocessing</span> <span class="kn">import</span> <span class="n">PipeTransformer</span>

<span class="k">def</span> <span class="nf">preprocessing</span><span class="p">(</span><span class="n">dataf</span><span class="p">,</span> <span class="n">n_char</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gender</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">dataf</span> <span class="o">=</span> <span class="n">dataf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">n_char</span><span class="p">:</span>
        <span class="n">dataf</span><span class="p">[</span><span class="s1">&#39;nchar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataf</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">gender</span><span class="p">:</span>
        <span class="n">dataf</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">dataf</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;male&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dataf</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;sex&quot;</span><span class="p">])</span>

<span class="c1"># Important, don&#39;t forget to declare `n_char` and `gender` here.</span>
<span class="n">tfm</span> <span class="o">=</span> <span class="n">PipeTransformer</span><span class="p">(</span><span class="n">preprocessing</span><span class="p">,</span> <span class="n">n_char</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gender</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</code></pre></div>

<p>The <code>tfm</code> variable now represents a component that can be used in a scikit-learn
pipeline. We can also perform a cross-validated benchmark on the parameters our
preprocessing function.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>


<span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;prep&#39;</span><span class="p">,</span> <span class="n">tfm</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;mod&#39;</span><span class="p">,</span> <span class="n">GaussianNB</span><span class="p">())</span>
<span class="p">])</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;prep__n_char&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
    <span class="s2">&quot;prep__gender&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">params</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div>

<p>Once trained we can fetch the <code>grid.cv_results_</code> to get a glimpse at
the results of our pipeline.</p>
<table>
<thead>
<tr>
<th align="left">param_prep__gender</th>
<th align="left">param_prep__n_char</th>
<th align="right">mean_test_score</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">True</td>
<td align="left">True</td>
<td align="right">0.785714</td>
</tr>
<tr>
<td align="left">True</td>
<td align="left">False</td>
<td align="right">0.778711</td>
</tr>
<tr>
<td align="left">False</td>
<td align="left">True</td>
<td align="right">0.70028</td>
</tr>
<tr>
<td align="left">False</td>
<td align="left">False</td>
<td align="right">0.67507</td>
</tr>
</tbody>
</table>
<p>It seems that we gender of the passenger has more of an effect on their
survival than the length of their name.</p>
<h2 id="utility">Utility<a class="headerlink" href="#utility" title="Permanent link">&para;</a></h2>
<p>The use-case here has been a relatively simple demonstration on a toy
dataset but hopefully you can recognize that this opens up a lot of
flexibility for your machine learning pipelines. You can keep the
preprocessing interpretable but you can keep everything running by
just writing pandas code.</p>
<p>There's a few small caveats to be aware of.</p>
<h3 id="dont-remove-data">Don't remove data<a class="headerlink" href="#dont-remove-data" title="Permanent link">&para;</a></h3>
<p>Pandas pipelines allow you to filter away rows, scikit-learn on the
other hand assumes this does not happen. Please be mindful of this.</p>
<h3 id="dont-sort-data">Don't sort data<a class="headerlink" href="#dont-sort-data" title="Permanent link">&para;</a></h3>
<p>You need to keep the order in your dataframe the same because otherwise
it will no longer correspond to the <code>y</code> variable that you're trying to
predict.</p>
<h3 id="dont-use-lambda">Don't use <code>lambda</code><a class="headerlink" href="#dont-use-lambda" title="Permanent link">&para;</a></h3>
<p>There's two ways that you can add a new column to pandas.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Method 1</span>
<span class="n">dataf_new</span> <span class="o">=</span> <span class="n">dataf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># Don&#39;t overwrite data!</span>
<span class="n">dataf_new</span><span class="p">[</span><span class="s1">&#39;new_column&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataf_new</span><span class="p">[</span><span class="s1">&#39;old_column&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>

<span class="c1"># Method 2</span>
<span class="n">dataf_new</span> <span class="o">=</span> <span class="n">dataf</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;old_column&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div>

<p>In many cases you might argue that method #2 is safer because you
do not need to worry about the <code>dataf.copy()</code> that needs to happen.
In our case however, we cannot use it. The grid-search no longer works
inside of scikit-learn if you use <code>lambda</code> functions because it cannot
pickle the code.</p>
<h3 id="dont-cheat">Don't Cheat!<a class="headerlink" href="#dont-cheat" title="Permanent link">&para;</a></h3>
<p>The functions that you write are supposed to be stateless in the sense
that they don't learn from the data that goes in. You could theoretically
bypass this with global variables but by doing so you're doing yourself
a disservice. If you do this you'll be cheating the statistics by leaking
information.</p>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../../function-classifier/function-classifier/" class="md-footer__link md-footer__link--prev" aria-label="TrÆ°á»›c: Function as a Model VN" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                TrÆ°á»›c
              </span>
              Function as a Model VN
            </div>
          </div>
        </a>
      
      
        
        <a href="../../drawing-classifier/drawing/" class="md-footer__link md-footer__link--next" aria-label="Sau: Drawing as a Model VN" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Sau
              </span>
              Drawing as a Model VN
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
    
    <div class="md-copyright__highlight">
        Copyright &copy; 2022 pmtmrw
    </div>
    
    
    
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.top"], "search": "../../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Sao ch\u00e9p xong", "clipboard.copy": "Sao ch\u00e9p v\u00e0o b\u1ed9 nh\u1edb", "search.config.lang": "vi", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "T\u00ecm ki\u1ebfm", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "Kh\u00f4ng t\u00ecm th\u1ea5y t\u00e0i li\u1ec7u li\u00ean quan", "search.result.one": "1 t\u00e0i li\u1ec7u li\u00ean quan", "search.result.other": "# t\u00e0i li\u1ec7u li\u00ean quan", "search.result.placeholder": "Nh\u1eadp \u0111\u1ec3 b\u1eaft \u0111\u1ea7u t\u00ecm ki\u1ebfm", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.0238f547.min.js"></script>
      
    
  </body>
</html>